<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Edit Project - Tonnie Roofing Admin</title>
    <style>
        /* Complete CSS for Admin Project Edit Page */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f8f9fa;
            overflow: hidden;
            height: 100vh;
        }
        
        /* Dark Theme for Admin */
        body.dark-theme {
            background: #1a1a1a;
            color: #e0e0e0;
        }
        
        body.dark-theme .sidebar {
            background: #1e1e1e;
        }
        
        body.dark-theme .top-bar,
        body.dark-theme .form-container,
        body.dark-theme .sidebar-form,
        body.dark-theme .service-fields,
        body.dark-theme .image-upload-section {
            background: #2d2d2d;
            color: #e0e0e0;
            border-color: #444;
        }
        
        body.dark-theme .nav-item {
            color: #b0b0b0;
        }
        
        body.dark-theme .nav-item:hover,
        body.dark-theme .nav-item.active {
            background: #2d2d2d;
            color: #d97706;
        }
        
        body.dark-theme .page-title h1,
        body.dark-theme .page-title p,
        body.dark-theme .form-header h2,
        body.dark-theme .section-title {
            color: #e0e0e0;
        }
        
        body.dark-theme .form-label {
            color: #e0e0e0;
        }
        
        body.dark-theme .form-control {
            background: #3d3d3d;
            border-color: #555;
            color: #e0e0e0;
        }
        
        body.dark-theme .form-control:focus {
            border-color: #d97706;
            background: #4d4d4d;
        }
        
        body.dark-theme .service-option {
            background: #3d3d3d;
            border-color: #555;
            color: #e0e0e0;
        }
        
        body.dark-theme .service-option:hover {
            border-color: #d97706;
        }
        
        body.dark-theme .service-option.active {
            background: #d97706;
            color: white;
        }
        
        body.dark-theme .image-item {
            background: #3d3d3d;
        }
        
        body.dark-theme .image-description input {
            background: #3d3d3d;
            border-color: #555;
            color: #e0e0e0;
        }
        
        body.dark-theme .upload-placeholder {
            background: #3d3d3d;
            border-color: #555;
            color: #b0b0b0;
        }
        
        body.dark-theme .upload-placeholder:hover {
            border-color: #d97706;
            color: #d97706;
        }
        
        /* No scrollbar */
        body, html {
            overflow: hidden;
            height: 100%;
        }
        
        .main-content {
            height: 100vh;
            overflow-y: auto;
            overflow-x: hidden;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }
        
        .main-content::-webkit-scrollbar {
            display: none;
        }
        
        /* Admin Layout */
        .admin-container {
            display: grid;
            grid-template-columns: 280px 1fr;
            min-height: 100vh;
        }
        
        /* Sidebar */
        .sidebar {
            background: #1a202c;
            color: white;
            height: 100vh;
            position: fixed;
            width: 280px;
            overflow-y: auto;
            scrollbar-width: none;
            z-index: 100;
        }
        
        .sidebar::-webkit-scrollbar {
            display: none;
        }
        
        .sidebar-header {
            padding: 2rem 1.5rem;
            border-bottom: 1px solid #2d3748;
        }
        
        .sidebar-header .logo {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .sidebar-header .logo img {
            height: 40px;
            width: auto;
            object-fit: contain;
        }
        
        .sidebar-header .logo span {
            font-size: 1.3rem;
            font-weight: bold;
            color: #d97706;
        }
        
        .sidebar-header .logo small {
            color: #a0aec0;
            font-size: 0.8rem;
            display: block;
            margin-top: 0.2rem;
        }
        
        .nav-menu {
            padding: 1.5rem 0;
        }
        
        .nav-section {
            margin-bottom: 1.5rem;
        }
        
        .nav-section-title {
            padding: 0 1.5rem;
            margin-bottom: 0.5rem;
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: #a0aec0;
        }
        
        .nav-item {
            display: flex;
            align-items: center;
            gap: 0.8rem;
            padding: 0.8rem 1.5rem;
            color: #cbd5e0;
            text-decoration: none;
            transition: all 0.3s;
            border-left: 3px solid transparent;
            min-height: 48px;
        }
        
        .nav-item:hover {
            background: #2d3748;
            color: white;
        }
        
        .nav-item.active {
            background: #2d3748;
            color: #d97706;
            border-left-color: #d97706;
        }
        
        .nav-item i {
            width: 24px;
            font-size: 1.2rem;
        }
        
        .badge {
            margin-left: auto;
            background: #d97706;
            color: white;
            padding: 0.2rem 0.5rem;
            border-radius: 50px;
            font-size: 0.7rem;
        }
        
        /* Main Area */
        .main-area {
            margin-left: 280px;
            padding: 2rem;
        }
        
        /* Top Bar */
        .top-bar {
            background: white;
            border-radius: 15px;
            padding: 1rem 2rem;
            margin-bottom: 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        .page-title h1 {
            font-size: 1.5rem;
            color: #333;
            margin-bottom: 0.2rem;
        }
        
        .page-title p {
            color: #666;
            font-size: 0.9rem;
        }
        
        .admin-profile {
            display: flex;
            align-items: center;
            gap: 1.5rem;
        }
        
        .theme-toggle {
            background: none;
            border: none;
            font-size: 1.3rem;
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 50%;
            transition: background 0.3s;
        }
        
        .theme-toggle:hover {
            background: #f0f0f0;
        }
        
        .admin-avatar {
            width: 44px;
            height: 44px;
            background: #d97706;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 1.2rem;
        }
        
        /* Form Container */
        .form-container {
            background: white;
            border-radius: 15px;
            padding: 2rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        .form-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid #eee;
        }
        
        .form-header h2 {
            font-size: 1.3rem;
            color: #333;
        }
        
        .form-actions {
            display: flex;
            gap: 1rem;
        }
        
        .btn {
            padding: 0.8rem 1.8rem;
            border-radius: 50px;
            border: none;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            min-height: 48px;
            font-size: 0.95rem;
        }
        
        .btn-primary {
            background: #d97706;
            color: white;
        }
        
        .btn-primary:hover {
            background: #b45f06;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(217, 119, 6, 0.3);
        }
        
        .btn-secondary {
            background: #f8f9fa;
            color: #666;
            border: 1px solid #ddd;
        }
        
        .btn-secondary:hover {
            background: #e9ecef;
        }
        
        .btn-danger {
            background: #dc3545;
            color: white;
        }
        
        .btn-danger:hover {
            background: #c82333;
        }
        
        /* Form Grid */
        .form-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 2rem;
        }
        
        /* Main Form */
        .form-section {
            margin-bottom: 2rem;
            padding-bottom: 2rem;
            border-bottom: 1px solid #eee;
        }
        
        .form-section:last-child {
            border-bottom: none;
        }
        
        .section-title {
            font-size: 1.1rem;
            color: #333;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-bottom: 1rem;
        }
        
        .form-group {
            margin-bottom: 1rem;
        }
        
        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            color: #555;
            font-weight: 500;
            font-size: 0.9rem;
        }
        
        .form-control {
            width: 100%;
            padding: 0.8rem 1rem;
            border: 2px solid #eee;
            border-radius: 10px;
            font-size: 0.95rem;
            transition: all 0.3s;
            background: #f8f9fa;
        }
        
        .form-control:focus {
            outline: none;
            border-color: #d97706;
            background: white;
        }
        
        textarea.form-control {
            resize: vertical;
            min-height: 100px;
        }
        
        select.form-control {
            appearance: none;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 1rem center;
            background-size: 1em;
        }
        
        /* Service Type Selection */
        .service-selector {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            margin-bottom: 2rem;
        }
        
        .service-option {
            background: #f8f9fa;
            border: 2px solid #eee;
            border-radius: 10px;
            padding: 1.2rem;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }
        
        .service-option:hover {
            border-color: #d97706;
        }
        
        .service-option.active {
            background: #d97706;
            border-color: #d97706;
            color: white;
        }
        
        .service-option i {
            font-size: 2rem;
            display: block;
            margin-bottom: 0.5rem;
        }
        
        .service-option span {
            font-weight: 600;
        }
        
        /* Image Upload Section */
        .image-upload-section {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 1.5rem;
            margin: 1.5rem 0;
        }
        
        .image-upload-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }
        
        .image-count {
            font-size: 0.9rem;
            color: #666;
        }
        
        .add-image-btn {
            background: #d97706;
            color: white;
            border: none;
            padding: 0.6rem 1.2rem;
            border-radius: 50px;
            cursor: pointer;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.3s;
            min-height: 44px;
        }
        
        .add-image-btn:hover {
            background: #b45f06;
        }
        
        .image-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 1rem;
        }
        
        .image-item {
            position: relative;
            border-radius: 10px;
            overflow: hidden;
            border: 2px solid #ddd;
        }
        
        .image-preview {
            aspect-ratio: 1;
            width: 100%;
            object-fit: cover;
        }
        
        .image-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        .image-item:hover .image-overlay {
            opacity: 1;
        }
        
        .image-action {
            width: 36px;
            height: 36px;
            background: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 1rem;
        }
        
        .image-action:hover {
            background: #d97706;
            color: white;
        }
        
        .image-action.delete:hover {
            background: #dc3545;
            color: white;
        }
        
        .image-description {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(0,0,0,0.7);
            padding: 0.5rem;
        }
        
        .image-description input {
            width: 100%;
            padding: 0.3rem;
            border: none;
            border-radius: 5px;
            font-size: 0.7rem;
            background: white;
        }
        
        .image-order {
            position: absolute;
            top: 5px;
            left: 5px;
            background: #d97706;
            color: white;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: bold;
        }
        
        .upload-placeholder {
            aspect-ratio: 1;
            border: 2px dashed #ddd;
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
            background: white;
        }
        
        .upload-placeholder:hover {
            border-color: #d97706;
            color: #d97706;
        }
        
        .upload-placeholder i {
            font-size: 2rem;
            margin-bottom: 0.3rem;
        }
        
        .upload-placeholder span {
            font-size: 0.8rem;
        }
        
        /* Service Specific Fields */
        .service-fields {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            display: none;
        }
        
        .service-fields.active {
            display: block;
        }
        
        /* Materials List */
        .materials-list {
            margin-bottom: 1rem;
        }
        
        .material-row {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
        }
        
        .material-row input {
            flex: 1;
        }
        
        .material-row input:first-child {
            flex: 2;
        }
        
        .remove-material {
            width: 40px;
            height: 40px;
            background: #dc3545;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            transition: background 0.3s;
        }
        
        .remove-material:hover {
            background: #c82333;
        }
        
        .add-material {
            background: #f8f9fa;
            border: 1px dashed #ddd;
            padding: 0.8rem;
            border-radius: 8px;
            cursor: pointer;
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            transition: all 0.3s;
            min-height: 48px;
        }
        
        .add-material:hover {
            border-color: #d97706;
            color: #d97706;
        }
        
        /* Sidebar Form */
        .sidebar-form {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 1.5rem;
        }
        
        /* Toggle Switch */
        .toggle-switch {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .toggle {
            width: 50px;
            height: 26px;
            background: #ddd;
            border-radius: 13px;
            position: relative;
            cursor: pointer;
            transition: background 0.3s;
        }
        
        .toggle.active {
            background: #4caf50;
        }
        
        .toggle::after {
            content: '';
            position: absolute;
            width: 22px;
            height: 22px;
            background: white;
            border-radius: 50%;
            top: 2px;
            left: 2px;
            transition: transform 0.3s;
        }
        
        .toggle.active::after {
            transform: translateX(24px);
        }
        
        /* Responsive */
        @media (max-width: 1200px) {
            .image-grid {
                grid-template-columns: repeat(4, 1fr);
            }
        }
        
        @media (max-width: 992px) {
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .image-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }
        
        @media (max-width: 768px) {
            .admin-container {
                grid-template-columns: 1fr;
            }
            
            .sidebar {
                display: none;
            }
            
            .main-area {
                margin-left: 0;
                padding: 1rem;
            }
            
            .service-selector {
                grid-template-columns: 1fr;
            }
            
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .image-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .form-header {
                flex-direction: column;
                gap: 1rem;
                align-items: flex-start;
            }
            
            .form-actions {
                width: 100%;
            }
            
            .form-actions .btn {
                flex: 1;
            }
        }
        
        @media (max-width: 480px) {
            .image-grid {
                grid-template-columns: 1fr;
            }
            
            .material-row {
                flex-wrap: wrap;
            }
            
            .material-row input {
                width: 100%;
            }
            
            .remove-material {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="admin-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <img src="/static/uploads/tonnie-logo.png" alt="Tonnie Roofing">
                    <div>
                        <span>TONNIE</span>
                        <small>Admin Panel</small>
                    </div>
                </div>
            </div>
            
            <nav class="nav-menu">
                <div class="nav-section">
                    <div class="nav-section-title">Main</div>
                    <a href="/admin/dashboard" class="nav-item">
                        <i>üìä</i> Dashboard
                    </a>
                    <a href="/admin/analytics" class="nav-item">
                        <i>üìà</i> Analytics
                    </a>
                </div>
                
                <div class="nav-section">
                    <div class="nav-section-title">Content</div>
                    <a href="/admin/projects" class="nav-item active">
                        <i>üèóÔ∏è</i> Projects
                    </a>
                    <a href="/admin/services" class="nav-item">
                        <i>üõ†Ô∏è</i> Services
                    </a>
                    <a href="/admin/inquiries" class="nav-item">
                        <i>üì®</i> Inquiries
                        <span class="badge">8</span>
                    </a>
                </div>
                
                <div class="nav-section">
                    <div class="nav-section-title">Settings</div>
                    <a href="/admin/profile" class="nav-item">
                        <i>üë§</i> Profile
                    </a>
                    <a href="#" class="nav-item" onclick="logout()">
                        <i>üö™</i> Logout
                    </a>
                </div>
            </nav>
        </aside>
        
        <!-- Main Content Area -->
        <main class="main-area">
            <!-- Top Bar -->
            <div class="top-bar">
                <div class="page-title">
                    <h1 id="formTitle">Add New Project</h1>
                    <p>Fill in the project details below</p>
                </div>
                
                <div class="admin-profile">
                    <button class="theme-toggle" onclick="toggleTheme()">üåì</button>
                    <div class="admin-avatar">JT</div>
                </div>
            </div>
            
            <!-- Form Container -->
            <div class="form-container">
                <div class="form-header">
                    <h2>Project Information</h2>
                    <div class="form-actions">
                        <button class="btn btn-secondary" onclick="cancelEdit()">Cancel</button>
                        <button class="btn btn-primary" onclick="saveProject()">Save Project</button>
                    </div>
                </div>
                
                <form id="projectForm">
                    <!-- Service Type Selection -->
                    <div class="form-section">
                        <div class="section-title">
                            <span>üõ†Ô∏è</span> Service Type
                        </div>
                        <div class="service-selector">
                            <div class="service-option active" onclick="selectService('roofing')">
                                <i>üè†</i>
                                <span>Roofing</span>
                            </div>
                            <div class="service-option" onclick="selectService('interior')">
                                <i>‚ú®</i>
                                <span>Interior Design</span>
                            </div>
                            <div class="service-option" onclick="selectService('repairs')">
                                <i>üîß</i>
                                <span>Repairs</span>
                            </div>
                            <div class="service-option" onclick="selectService('quoting')">
                                <i>üìã</i>
                                <span>Quoting</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Basic Information -->
                    <div class="form-section">
                        <div class="section-title">
                            <span>üìã</span> Basic Information
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Project Title *</label>
                            <input type="text" class="form-control" id="projectTitle" placeholder="e.g., Modern Roof Installation">
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Start Date</label>
                                <input type="date" class="form-control" id="startDate">
                            </div>
                            <div class="form-group">
                                <label class="form-label">End Date</label>
                                <input type="date" class="form-control" id="endDate">
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Short Description</label>
                            <textarea class="form-control" id="shortDescription" rows="2" placeholder="Brief description for cards"></textarea>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Full Description</label>
                            <textarea class="form-control" id="fullDescription" rows="4" placeholder="Detailed project description"></textarea>
                        </div>
                    </div>
                    
                    <!-- Image Upload Section -->
                    <div class="form-section">
                        <div class="section-title">
                            <span>üñºÔ∏è</span> Project Images (Max 10)
                        </div>
                        
                        <div class="image-upload-section">
                            <div class="image-upload-header">
                                <span class="image-count" id="imageCount">0 of 10 images used</span>
                                <button type="button" class="add-image-btn" onclick="addImages()">
                                    <span>‚ûï</span> Add Images
                                </button>
                            </div>
                            
                            <div class="image-grid" id="imageGrid">
                                <!-- Images will be added here dynamically -->
                                <div class="upload-placeholder" onclick="addImages()">
                                    <i>‚ûï</i>
                                    <span>Upload Image</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Location Information -->
                    <div class="form-section">
                        <div class="section-title">
                            <span>üìç</span> Location
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">County *</label>
                                <select class="form-control" id="county">
                                    <option value="">Select County</option>
                                    <option value="Baringo">Baringo</option>
                                    <option value="Bomet">Bomet</option>
                                    <option value="Bungoma">Bungoma</option>
                                    <option value="Busia">Busia</option>
                                    <option value="Elgeyo Marakwet">Elgeyo Marakwet</option>
                                    <option value="Embu">Embu</option>
                                    <option value="Garissa">Garissa</option>
                                    <option value="Homa Bay">Homa Bay</option>
                                    <option value="Isiolo">Isiolo</option>
                                    <option value="Kajiado">Kajiado</option>
                                    <option value="Kakamega">Kakamega</option>
                                    <option value="Kericho">Kericho</option>
                                    <option value="Kiambu">Kiambu</option>
                                    <option value="Kilifi">Kilifi</option>
                                    <option value="Kirinyaga">Kirinyaga</option>
                                    <option value="Kisii">Kisii</option>
                                    <option value="Kisumu">Kisumu</option>
                                    <option value="Kitui">Kitui</option>
                                    <option value="Kwale">Kwale</option>
                                    <option value="Laikipia">Laikipia</option>
                                    <option value="Lamu">Lamu</option>
                                    <option value="Machakos">Machakos</option>
                                    <option value="Makueni">Makueni</option>
                                    <option value="Mandera">Mandera</option>
                                    <option value="Marsabit">Marsabit</option>
                                    <option value="Meru">Meru</option>
                                    <option value="Migori">Migori</option>
                                    <option value="Mombasa">Mombasa</option>
                                    <option value="Murang'a">Murang'a</option>
                                    <option value="Nairobi">Nairobi</option>
                                    <option value="Nakuru">Nakuru</option>
                                    <option value="Nandi">Nandi</option>
                                    <option value="Narok">Narok</option>
                                    <option value="Nyamira">Nyamira</option>
                                    <option value="Nyandarua">Nyandarua</option>
                                    <option value="Nyeri">Nyeri</option>
                                    <option value="Samburu">Samburu</option>
                                    <option value="Siaya">Siaya</option>
                                    <option value="Taita Taveta">Taita Taveta</option>
                                    <option value="Tana River">Tana River</option>
                                    <option value="Tharaka Nithi">Tharaka Nithi</option>
                                    <option value="Trans Nzoia">Trans Nzoia</option>
                                    <option value="Turkana">Turkana</option>
                                    <option value="Uasin Gishu">Uasin Gishu</option>
                                    <option value="Vihiga">Vihiga</option>
                                    <option value="Wajir">Wajir</option>
                                    <option value="West Pokot">West Pokot</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Area</label>
                                <input type="text" class="form-control" id="area" placeholder="e.g., Kilimani">
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Exact Location</label>
                            <input type="text" class="form-control" id="exactLocation" placeholder="e.g., Argwings Kodhek Road">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Landmark (Optional)</label>
                            <input type="text" class="form-control" id="landmark" placeholder="e.g., Near Kilimani Mall">
                        </div>
                    </div>
                    
                    <!-- Roofing Fields -->
                    <div class="service-fields active" id="roofingFields">
                        <div class="section-title">
                            <span>üè†</span> Roofing Details
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Roof Type</label>
                                <select class="form-control" id="roofType">
                                    <option>Pitched Roof</option>
                                    <option>Flat Roof</option>
                                    <option>Gable Roof</option>
                                    <option>Hip Roof</option>
                                    <option>Mansard Roof</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Roofing Sheets</label>
                                <select class="form-control" id="roofingSheets">
                                    <option>Dumu Zas - 28 Gauge</option>
                                    <option>Dumu Zas - 26 Gauge</option>
                                    <option>Versatile - 28 Gauge</option>
                                    <option>Versatile - 26 Gauge</option>
                                    <option>Box Profile - 0.3mm</option>
                                    <option>Box Profile - 0.5mm</option>
                                    <option>Roman Tile</option>
                                    <option>Corrugated GCI - 28 Gauge</option>
                                    <option>Corrugated GCI - 26 Gauge</option>
                                    <option>Decra Tiles</option>
                                    <option>Color Bond</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Advantage</label>
                            <input type="text" class="form-control" id="advantage" placeholder="e.g., Durable, Weather-resistant">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Warranty</label>
                            <input type="text" class="form-control" id="warranty" placeholder="e.g., 25 Years">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Materials Used</label>
                            <div id="materialsList" class="materials-list">
                                <!-- Material rows will be added here -->
                            </div>
                            <button type="button" class="add-material" onclick="addMaterial()">
                                <span>‚ûï</span> Add Material
                            </button>
                        </div>
                    </div>
                    
                    <!-- Interior Design Fields -->
                    <div class="service-fields" id="interiorFields">
                        <div class="section-title">
                            <span>‚ú®</span> Interior Design Details
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Interior Type</label>
                                <select class="form-control" id="interiorType">
                                    <option>Gypsum Ceiling</option>
                                    <option>Wall Partitions</option>
                                    <option>Custom Fittings</option>
                                    <option>Full Interior Design</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Material</label>
                                <input type="text" class="form-control" id="material" placeholder="e.g., Gypsum Board">
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Room Area (sq m)</label>
                                <input type="number" class="form-control" id="roomArea" placeholder="e.g., 50">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Number of Rooms</label>
                                <input type="number" class="form-control" id="numRooms" placeholder="e.g., 3">
                            </div>
                        </div>
                    </div>
                    
                    <!-- Repairs Fields -->
                    <div class="service-fields" id="repairsFields">
                        <div class="section-title">
                            <span>üîß</span> Repair Details
                        </div>
                        
                        <div class="working-days-notice" style="background: rgba(217,119,6,0.1); padding: 1rem; border-radius: 5px; margin-bottom: 1rem;">
                            <p style="color: #666; display: flex; align-items: center; gap: 0.5rem;">
                                <span>‚è∞</span>
                                <strong>Note:</strong> Repairs are available on working days only (Monday to Friday, 8:00 AM - 6:00 PM)
                            </p>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Problem Description</label>
                            <textarea class="form-control" id="problemDescription" rows="3" placeholder="Describe the problem..."></textarea>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Repair Type</label>
                                <select class="form-control" id="repairType">
                                    <option>Emergency Repair</option>
                                    <option>Routine Maintenance</option>
                                    <option>Restoration</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Urgency</label>
                                <select class="form-control" id="urgency">
                                    <option>Emergency (24h)</option>
                                    <option>Urgent (2-3 days)</option>
                                    <option>Normal (1 week)</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Quoting Fields -->
                    <div class="service-fields" id="quotingFields">
                        <div class="section-title">
                            <span>üìã</span> Quoting Details
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Services for Quote</label>
                            <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                                <label><input type="checkbox" value="roofing"> Roofing</label>
                                <label><input type="checkbox" value="interior"> Interior Design</label>
                                <label><input type="checkbox" value="both"> Both</label>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Project Scope</label>
                            <textarea class="form-control" rows="3" placeholder="Describe what needs to be quoted..."></textarea>
                        </div>
                    </div>
                    
                    <!-- Sidebar Form (Right Column) -->
                    <div class="sidebar-form">
                        <div class="form-group">
                            <label class="form-label">Project Status</label>
                            <select class="form-control" id="projectStatus">
                                <option value="active">Active</option>
                                <option value="completed">Completed</option>
                                <option value="ongoing">Ongoing</option>
                                <option value="draft">Draft</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Featured Project</label>
                            <div class="toggle-switch">
                                <div class="toggle" id="featuredToggle" onclick="toggleFeatured(this)"></div>
                                <span>Show on homepage</span>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Property Type</label>
                            <select class="form-control" id="propertyType">
                                <option value="residential">Residential</option>
                                <option value="commercial">Commercial</option>
                                <option value="industrial">Industrial</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Client Name (Optional)</label>
                            <input type="text" class="form-control" id="clientName" placeholder="e.g., Mr. & Mrs. Mwangi">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Project Value (KES)</label>
                            <input type="text" class="form-control" id="projectCost" placeholder="e.g., 450,000">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Tags</label>
                            <input type="text" class="form-control" id="tags" placeholder="Comma separated, e.g., roofing, modern">
                        </div>
                    </div>
                </form>
            </div>
        </main>
    </div>
    
    <script>
        let currentService = 'roofing';
        let imageCount = 0;
        let images = [];
        
        // Check authentication
        document.addEventListener('DOMContentLoaded', function() {
            const adminSession = localStorage.getItem('adminSession');
            if (!adminSession) {
                window.location.href = '/admin/login?error=unauthorized';
                return;
            }
            
            // Load saved theme
            const savedTheme = localStorage.getItem('adminTheme');
            if (savedTheme === 'dark') {
                document.body.classList.add('dark-theme');
            }
            
            // Check if editing existing project
            const urlParams = new URLSearchParams(window.location.search);
            const projectId = urlParams.get('id');
            if (projectId) {
                document.getElementById('formTitle').textContent = 'Edit Project';
                loadProjectData(projectId);
            } else {
                // Add initial material row for roofing
                addMaterial();
            }
            
            updateImageCount();
        });
        
        // Theme toggle
        function toggleTheme() {
            document.body.classList.toggle('dark-theme');
            const isDark = document.body.classList.contains('dark-theme');
            localStorage.setItem('adminTheme', isDark ? 'dark' : 'light');
        }
        
        // Select service type
        function selectService(service) {
            const options = document.querySelectorAll('.service-option');
            options.forEach(opt => {
                opt.classList.remove('active');
            });
            event.currentTarget.classList.add('active');
            
            document.querySelectorAll('.service-fields').forEach(field => {
                field.classList.remove('active');
            });
            
            document.getElementById(service + 'Fields').classList.add('active');
            currentService = service;
        }
        
        // Toggle featured
        function toggleFeatured(element) {
            element.classList.toggle('active');
        }
        
        // Add images
        function addImages() {
            if (imageCount >= 10) {
                alert('Maximum 10 images allowed');
                return;
            }
            
            const input = document.createElement('input');
            input.type = 'file';
            input.multiple = true;
            input.accept = 'image/*';
            input.onchange = function(e) {
                const files = Array.from(e.target.files);
                const remainingSlots = 10 - imageCount;
                
                if (files.length > remainingSlots) {
                    alert(`You can only add ${remainingSlots} more image(s)`);
                    return;
                }
                
                files.forEach((file, index) => {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        addImageToGrid(e.target.result, `Image ${imageCount + 1}`);
                    };
                    reader.readAsDataURL(file);
                });
            };
            input.click();
        }
        
        // Add image to grid
        function addImageToGrid(src, description) {
            const grid = document.getElementById('imageGrid');
            const uploadPlaceholder = grid.lastElementChild;
            
            const imageId = Date.now() + imageCount;
            images.push({
                id: imageId,
                src: src,
                description: description
            });
            
            const imageItem = document.createElement('div');
            imageItem.className = 'image-item';
            imageItem.dataset.id = imageId;
            imageItem.innerHTML = `
                <img src="${src}" class="image-preview" alt="Project Image">
                <div class="image-order">${imageCount + 1}</div>
                <div class="image-overlay">
                    <div class="image-action" onclick="editImage(${imageId})" title="Edit Description">‚úèÔ∏è</div>
                    <div class="image-action" onclick="setAsFeatured(${imageId})" title="Set as Featured">‚≠ê</div>
                    <div class="image-action delete" onclick="deleteImage(${imageId})" title="Delete">üóëÔ∏è</div>
                </div>
                <div class="image-description">
                    <input type="text" value="${description}" placeholder="Image description" onchange="updateImageDescription(${imageId}, this.value)">
                </div>
            `;
            
            grid.insertBefore(imageItem, uploadPlaceholder);
            imageCount++;
            updateImageCount();
        }
        
        // Update image count
        function updateImageCount() {
            document.getElementById('imageCount').textContent = `${imageCount} of 10 images used`;
        }
        
        // Delete image
        function deleteImage(imageId) {
            if (confirm('Are you sure you want to delete this image?')) {
                const imageItem = document.querySelector(`.image-item[data-id="${imageId}"]`);
                imageItem.remove();
                images = images.filter(img => img.id !== imageId);
                imageCount--;
                
                // Reorder remaining images
                const items = document.querySelectorAll('.image-item');
                items.forEach((item, index) => {
                    item.querySelector('.image-order').textContent = index + 1;
                });
                
                updateImageCount();
            }
        }
        
        // Edit image description
        function editImage(imageId) {
            const input = document.querySelector(`.image-item[data-id="${imageId}"] .image-description input`);
            input.focus();
        }
        
        // Update image description
        function updateImageDescription(imageId, description) {
            const image = images.find(img => img.id === imageId);
            if (image) {
                image.description = description;
            }
        }
        
        // Set as featured
        function setAsFeatured(imageId) {
            document.querySelectorAll('.image-item').forEach(item => {
                item.style.border = '2px solid #ddd';
            });
            
            const selected = document.querySelector(`.image-item[data-id="${imageId}"]`);
            selected.style.border = '2px solid #d97706';
            
            alert('Image set as featured');
        }
        
        // Add material row
        function addMaterial() {
            const list = document.getElementById('materialsList');
            const row = document.createElement('div');
            row.className = 'material-row';
            row.innerHTML = `
                <input type="text" class="form-control" placeholder="Material name" value="">
                <input type="text" class="form-control" placeholder="Quantity" value="">
                <button type="button" class="remove-material" onclick="removeMaterial(this)">‚úñ</button>
            `;
            list.appendChild(row);
        }
        
        // Remove material row
        function removeMaterial(button) {
            if (document.querySelectorAll('.material-row').length > 1) {
                button.closest('.material-row').remove();
            } else {
                alert('At least one material row is required');
            }
        }
        
        // Load project data for editing
        function loadProjectData(projectId) {
            console.log('Loading project:', projectId);
            
            // Simulate loading data
            if (projectId == 1) {
                document.getElementById('projectTitle').value = 'Modern Roof Installation';
                document.getElementById('startDate').value = '2026-02-20';
                document.getElementById('endDate').value = '2026-03-15';
                document.getElementById('shortDescription').value = 'Complete roof replacement with Dumu zas 28 gauge sheets';
                document.getElementById('fullDescription').value = 'Complete roof replacement for a modern residential home in Kilimani, Nairobi. The project involved removing the old roofing material and installing high-quality Dumu zas 28 gauge sheets.';
                
                document.getElementById('county').value = 'Nairobi';
                document.getElementById('area').value = 'Kilimani';
                document.getElementById('exactLocation').value = 'Argwings Kodhek Road';
                document.getElementById('landmark').value = 'Near Kilimani Mall';
                
                document.getElementById('projectStatus').value = 'completed';
                document.getElementById('propertyType').value = 'residential';
                document.getElementById('clientName').value = 'Mr. & Mrs. Mwangi';
                document.getElementById('projectCost').value = '450,000';
                document.getElementById('tags').value = 'roofing, residential, modern';
                
                // Roofing specific
                document.getElementById('roofType').value = 'Pitched Roof';
                document.getElementById('roofingSheets').value = 'Dumu Zas - 28 Gauge';
                document.getElementById('advantage').value = 'Durable, Weather-resistant';
                document.getElementById('warranty').value = '25 Years';
                
                // Add sample materials
                addMaterial();
                const materials = document.querySelectorAll('.material-row');
                if (materials.length > 0) {
                    materials[0].querySelectorAll('input')[0].value = 'Dumu Zas 28 Gauge';
                    materials[0].querySelectorAll('input')[1].value = '850 pcs';
                }
                addMaterial();
                const materials2 = document.querySelectorAll('.material-row');
                if (materials2.length > 1) {
                    materials2[1].querySelectorAll('input')[0].value = 'Waterproofing Membrane';
                    materials2[1].querySelectorAll('input')[1].value = '120 m¬≤';
                }
                
                // Add sample images
                for (let i = 1; i <= 8; i++) {
                    addImageToGrid(`/static/uploads/projects/roofing-nairobi-${i}.jpg`, `Project image ${i}`);
                }
                
                // Set featured toggle
                document.getElementById('featuredToggle').classList.add('active');
            }
        }
        
        // Save project
        function saveProject() {
            const title = document.getElementById('projectTitle').value;
            if (!title) {
                alert('Please enter a project title');
                return;
            }
            
            const county = document.getElementById('county').value;
            if (!county) {
                alert('Please select a county');
                return;
            }
            
            // Collect form data
            const projectData = {
                id: new URLSearchParams(window.location.search).get('id') || 'proj_' + Date.now(),
                service: currentService,
                title: title,
                startDate: document.getElementById('startDate').value,
                endDate: document.getElementById('endDate').value,
                shortDescription: document.getElementById('shortDescription').value,
                fullDescription: document.getElementById('fullDescription').value,
                location: {
                    county: county,
                    area: document.getElementById('area').value,
                    exact: document.getElementById('exactLocation').value,
                    landmark: document.getElementById('landmark').value
                },
                status: document.getElementById('projectStatus').value,
                propertyType: document.getElementById('propertyType').value,
                clientName: document.getElementById('clientName').value,
                projectCost: document.getElementById('projectCost').value,
                tags: document.getElementById('tags').value,
                featured: document.getElementById('featuredToggle').classList.contains('active'),
                images: images,
                imageCount: imageCount
            };
            
            // Add service specific data
            if (currentService === 'roofing') {
                projectData.roofType = document.getElementById('roofType').value;
                projectData.roofingSheets = document.getElementById('roofingSheets').value;
                projectData.advantage = document.getElementById('advantage').value;
                projectData.warranty = document.getElementById('warranty').value;
                
                // Collect materials
                projectData.materials = [];
                document.querySelectorAll('.material-row').forEach(row => {
                    const inputs = row.querySelectorAll('input');
                    if (inputs[0].value && inputs[1].value) {
                        projectData.materials.push({
                            name: inputs[0].value,
                            quantity: inputs[1].value
                        });
                    }
                });
            }
            
            if (currentService === 'interior') {
                projectData.interiorType = document.getElementById('interiorType').value;
                projectData.material = document.getElementById('material').value;
                projectData.roomArea = document.getElementById('roomArea').value;
                projectData.numRooms = document.getElementById('numRooms').value;
            }
            
            if (currentService === 'repairs') {
                projectData.problemDescription = document.getElementById('problemDescription').value;
                projectData.repairType = document.getElementById('repairType').value;
                projectData.urgency = document.getElementById('urgency').value;
            }
            
            console.log('Saving project:', projectData);
            
            alert('Project saved successfully!');
            window.location.href = '/admin/projects';
        }
        
        // Cancel edit
        function cancelEdit() {
            if (confirm('Are you sure you want to cancel? Any unsaved changes will be lost.')) {
                window.location.href = '/admin/projects';
            }
        }
        
        // Logout
        function logout() {
            if (confirm('Are you sure you want to logout?')) {
                localStorage.removeItem('adminSession');
                localStorage.removeItem('rememberedUsername');
                localStorage.removeItem('adminTheme');
                window.location.href = '/admin/login';
            }
        }
        
        // Keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            // Ctrl + S to save
            if (e.ctrlKey && e.key === 's') {
                e.preventDefault();
                saveProject();
            }
        });
    </script>
</body>
</html>